#!/bin/bash

echo "=== CONFIGURACIรN RAC PROVIDER - VERSIรN HรBRIDA ==="
echo "Implementaciรณn SIN ROMPER tus conexiones existentes de Guacamole"
echo ""
echo "๐ URL de Authentik: https://34.68.124.46:9443"
echo "๐ค Usuario Admin: akadmin"
echo "๐ Password: Neogenesys123!!!"
echo ""

echo "๐ฏ ESTRATEGIA HรBRIDA RECOMENDADA:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ Mantener Guacamole actual funcionando (http://34.68.124.46:8080/guacamole/)"
echo "โ Agregar RAC Provider para SSO y gestiรณn centralizada"
echo "โ Los usuarios pueden usar ambos sistemas"
echo "โ Migraciรณn gradual segรบn conveniencia"
echo ""

echo "PASO 1: Crear RAC Provider"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "1. Ve a: Applications โ Providers"
echo "2. Haz clic en 'Create'"
echo "3. Selecciona: 'RAC Provider'"
echo ""
echo "Configuraciรณn del Provider:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ Name: Remote Access Provider                     โ"
echo "โ Authorization flow: default-authorization-flow   โ"
echo "โ Connection expiry: hours=24                      โ"
echo "โ Delete failing connections: โ MARCADO           โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

echo "PASO 2: Crear Aplicaciรณn"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "1. Ve a: Applications โ Applications"
echo "2. Haz clic en 'Create'"
echo "3. Configuraciรณn:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ Name: Remote Desktop Access                      โ"
echo "โ Slug: remote-desktop-access                      โ"
echo "โ Provider: Remote Access Provider                 โ"
echo "โ Launch URL: (dejar vacรญo)                        โ"
echo "โ Open in new tab: โ MARCADO                      โ"
echo "โ Icon (opcional): Upload logo si tienes           โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

echo "PASO 3: Configurar Endpoints - TUS CONEXIONES REALES"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "1. Ve a: Applications โ Providers โ Remote Access Provider"
echo "2. Haz clic en la pestaรฑa 'Endpoints'"
echo "3. Crea estos 4 endpoints basados en tu infraestructura:"
echo ""

echo "๐ฅ๏ธ  ENDPOINT 1: Windows Production (100.95.223.18)"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ Name: Windows Production Server                            โ"
echo "โ Host: 100.95.223.18                                       โ"
echo "โ Protocol: RDP                                              โ"
echo "โ Settings (clic en 'Show advanced'):                       โ"
echo "โ   Port: 3389                                               โ"
echo "โ   Width: 1920                                              โ"
echo "โ   Height: 1080                                             โ"
echo "โ   Color depth: 32                                          โ"
echo "โ   DPI: 96                                                  โ"
echo "โ   Username: soporte                                        โ"
echo "โ   Password: Neo123!!!                                      โ"
echo "โ   (o usar \${user.attributes.ldap_password} si estรก configurado) โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

echo "๐ฅ๏ธ  ENDPOINT 2: Windows Server Demo (192.168.1.100)"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ Name: Windows Server Demo                                  โ"
echo "โ Host: 192.168.1.100                                       โ"
echo "โ Protocol: RDP                                              โ"
echo "โ Settings:                                                  โ"
echo "โ   Port: 3389                                               โ"
echo "โ   Username: administrator                                  โ"
echo "โ   Password: [tu password de administrator]                 โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

echo "๐ง ENDPOINT 3: Ubuntu Server SSH (192.168.1.102)"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ Name: Ubuntu Server SSH                                    โ"
echo "โ Host: 192.168.1.102                                       โ"
echo "โ Protocol: SSH                                              โ"
echo "โ Settings:                                                  โ"
echo "โ   Port: 22                                                 โ"
echo "โ   Username: admin                                          โ"
echo "โ   Password: [tu password de admin]                        โ"
echo "โ   Terminal type: xterm-256color                           โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

echo "๐ผ๏ธ  ENDPOINT 4: Linux Desktop VNC (192.168.1.101)"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ Name: Linux Desktop VNC                                    โ"
echo "โ Host: 192.168.1.101                                       โ"
echo "โ Protocol: VNC                                              โ"
echo "โ Settings:                                                  โ"
echo "โ   Port: 5901                                               โ"
echo "โ   Password: [tu password de VNC]                          โ"
echo "โ   Color depth: 24-bit                                     โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

echo "PASO 4: Configurar Property Mappings (SI ES NECESARIO)"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "Solo si quieres usar credenciales dinรกmicas desde LDAP:"
echo "1. Ve a: Customization โ Property Mappings"
echo "2. Verifica que existan mappings de tipo 'RAC Provider'"
echo "3. Si no existen, no es crรญtico para la funcionalidad bรกsica"
echo ""

echo "PASO 5: Configurar Outpost"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "1. Ve a: Applications โ Outposts"
echo "2. Busca 'authentik Embedded Outpost' o crea uno nuevo"
echo "3. Edita la configuraciรณn:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ Name: authentik Embedded Outpost                 โ"
echo "โ Type: RAC                                        โ"
echo "โ Applications: Remote Desktop Access              โ"
echo "โ Configuration (YAML):                            โ"
echo "โ   authentik_host: https://34.68.124.46:9443     โ"
echo "โ   log_level: debug                               โ"
echo "โ   docker_network: null                          โ"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo ""

echo "PASO 6: Probar el Flujo SSO"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "1. Ve a: https://34.68.124.46:9443/if/user/"
echo "2. Login: soporte@kolaboree.local / Neo123!!!"
echo "3. Verรกs 'Remote Desktop Access' en tu dashboard"
echo "4. Haz clic en la aplicaciรณn"
echo "5. Deberรญas ver los 4 endpoints disponibles"
echo "6. Haz clic en 'Windows Production Server' para probar"
echo ""

echo "๐ VENTAJAS DE ESTA CONFIGURACIรN:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "โ HTML5: Sร, usa HTML5 Canvas en el navegador"
echo "โ Dinรกmico: Sร, completamente escalable para mรกs usuarios"
echo "โ Sin romper: Guacamole actual sigue funcionando normalmente"
echo "โ SSO: Un solo login para acceder a todas las conexiones"
echo "โ Centralizado: Gestiรณn de usuarios y conexiones desde Authentik"
echo "โ Auditable: Logs completos de quiรฉn accede a quรฉ"
echo ""

echo "๐ COMPARACIรN DE ACCESOS:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "MรTODO ACTUAL (Guacamole directo):"
echo "โข http://34.68.124.46:8080/guacamole/"
echo "โข Login individual en Guacamole"
echo "โข Gestiรณn manual de usuarios"
echo ""
echo "MรTODO NUEVO (RAC Provider):"
echo "โข https://34.68.124.46:9443/if/user/"
echo "โข Login รบnico con credenciales LDAP"
echo "โข Gestiรณn automรกtica desde Authentik"
echo ""

echo "๐ฏ RECOMENDACIรN:"
echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
echo "Implementa RAC Provider con tus 4 conexiones principales"
echo "Mantรฉn Guacamole como respaldo durante la transiciรณn"
echo "Evalรบa la experiencia de usuario antes de migrar completamente"
echo ""
echo "๐ ยฟLISTO PARA IMPLEMENTAR?"
echo "Sigue estos pasos y tendrรกs SSO funcionando en 15-20 minutos"