#!/bin/bash

echo "=== CONFIGURACIÃ“N RAC PROVIDER - VERSIÃ“N HÃBRIDA ==="
echo "ImplementaciÃ³n SIN ROMPER tus conexiones existentes de Guacamole"
echo ""
echo "ğŸ”— URL de Authentik: https://34.68.124.46:9443"
echo "ğŸ‘¤ Usuario Admin: akadmin"
echo "ğŸ” Password: Neogenesys123!!!"
echo ""

echo "ğŸ¯ ESTRATEGIA HÃBRIDA RECOMENDADA:"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… Mantener Guacamole actual funcionando (http://34.68.124.46:8080/guacamole/)"
echo "âœ… Agregar RAC Provider para SSO y gestiÃ³n centralizada"
echo "âœ… Los usuarios pueden usar ambos sistemas"
echo "âœ… MigraciÃ³n gradual segÃºn conveniencia"
echo ""

echo "PASO 1: Crear RAC Provider"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "1. Ve a: Applications â†’ Providers"
echo "2. Haz clic en 'Create'"
echo "3. Selecciona: 'RAC Provider'"
echo ""
echo "ConfiguraciÃ³n del Provider:"
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ Name: Remote Access Provider                     â”‚"
echo "â”‚ Authorization flow: default-authorization-flow   â”‚"
echo "â”‚ Connection expiry: hours=24                      â”‚"
echo "â”‚ Delete failing connections: âœ… MARCADO           â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo "PASO 2: Crear AplicaciÃ³n"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "1. Ve a: Applications â†’ Applications"
echo "2. Haz clic en 'Create'"
echo "3. ConfiguraciÃ³n:"
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ Name: Remote Desktop Access                      â”‚"
echo "â”‚ Slug: remote-desktop-access                      â”‚"
echo "â”‚ Provider: Remote Access Provider                 â”‚"
echo "â”‚ Launch URL: (dejar vacÃ­o)                        â”‚"
echo "â”‚ Open in new tab: âœ… MARCADO                      â”‚"
echo "â”‚ Icon (opcional): Upload logo si tienes           â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo "PASO 3: Configurar Endpoints - TUS CONEXIONES REALES"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "1. Ve a: Applications â†’ Providers â†’ Remote Access Provider"
echo "2. Haz clic en la pestaÃ±a 'Endpoints'"
echo "3. Crea estos 4 endpoints basados en tu infraestructura:"
echo ""

echo "ğŸ–¥ï¸  ENDPOINT 1: Windows Production (100.95.223.18)"
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ Name: Windows Production Server                            â”‚"
echo "â”‚ Host: 100.95.223.18                                       â”‚"
echo "â”‚ Protocol: RDP                                              â”‚"
echo "â”‚ Settings (clic en 'Show advanced'):                       â”‚"
echo "â”‚   Port: 3389                                               â”‚"
echo "â”‚   Width: 1920                                              â”‚"
echo "â”‚   Height: 1080                                             â”‚"
echo "â”‚   Color depth: 32                                          â”‚"
echo "â”‚   DPI: 96                                                  â”‚"
echo "â”‚   Username: soporte                                        â”‚"
echo "â”‚   Password: Neo123!!!                                      â”‚"
echo "â”‚   (o usar \${user.attributes.ldap_password} si estÃ¡ configurado) â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo "ğŸ–¥ï¸  ENDPOINT 2: Windows Server Demo (192.168.1.100)"
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ Name: Windows Server Demo                                  â”‚"
echo "â”‚ Host: 192.168.1.100                                       â”‚"
echo "â”‚ Protocol: RDP                                              â”‚"
echo "â”‚ Settings:                                                  â”‚"
echo "â”‚   Port: 3389                                               â”‚"
echo "â”‚   Username: administrator                                  â”‚"
echo "â”‚   Password: [tu password de administrator]                 â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo "ğŸ§ ENDPOINT 3: Ubuntu Server SSH (192.168.1.102)"
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ Name: Ubuntu Server SSH                                    â”‚"
echo "â”‚ Host: 192.168.1.102                                       â”‚"
echo "â”‚ Protocol: SSH                                              â”‚"
echo "â”‚ Settings:                                                  â”‚"
echo "â”‚   Port: 22                                                 â”‚"
echo "â”‚   Username: admin                                          â”‚"
echo "â”‚   Password: [tu password de admin]                        â”‚"
echo "â”‚   Terminal type: xterm-256color                           â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo "ğŸ–¼ï¸  ENDPOINT 4: Linux Desktop VNC (192.168.1.101)"
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ Name: Linux Desktop VNC                                    â”‚"
echo "â”‚ Host: 192.168.1.101                                       â”‚"
echo "â”‚ Protocol: VNC                                              â”‚"
echo "â”‚ Settings:                                                  â”‚"
echo "â”‚   Port: 5901                                               â”‚"
echo "â”‚   Password: [tu password de VNC]                          â”‚"
echo "â”‚   Color depth: 24-bit                                     â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo "PASO 4: Configurar Property Mappings (SI ES NECESARIO)"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "Solo si quieres usar credenciales dinÃ¡micas desde LDAP:"
echo "1. Ve a: Customization â†’ Property Mappings"
echo "2. Verifica que existan mappings de tipo 'RAC Provider'"
echo "3. Si no existen, no es crÃ­tico para la funcionalidad bÃ¡sica"
echo ""

echo "PASO 5: Configurar Outpost"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "1. Ve a: Applications â†’ Outposts"
echo "2. Busca 'authentik Embedded Outpost' o crea uno nuevo"
echo "3. Edita la configuraciÃ³n:"
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ Name: authentik Embedded Outpost                 â”‚"
echo "â”‚ Type: RAC                                        â”‚"
echo "â”‚ Applications: Remote Desktop Access              â”‚"
echo "â”‚ Configuration (YAML):                            â”‚"
echo "â”‚   authentik_host: https://34.68.124.46:9443     â”‚"
echo "â”‚   log_level: debug                               â”‚"
echo "â”‚   docker_network: null                          â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo "PASO 6: Probar el Flujo SSO"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "1. Ve a: https://34.68.124.46:9443/if/user/"
echo "2. Login: soporte@kolaboree.local / Neo123!!!"
echo "3. VerÃ¡s 'Remote Desktop Access' en tu dashboard"
echo "4. Haz clic en la aplicaciÃ³n"
echo "5. DeberÃ­as ver los 4 endpoints disponibles"
echo "6. Haz clic en 'Windows Production Server' para probar"
echo ""

echo "ğŸŒŸ VENTAJAS DE ESTA CONFIGURACIÃ“N:"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… HTML5: SÃ, usa HTML5 Canvas en el navegador"
echo "âœ… DinÃ¡mico: SÃ, completamente escalable para mÃ¡s usuarios"
echo "âœ… Sin romper: Guacamole actual sigue funcionando normalmente"
echo "âœ… SSO: Un solo login para acceder a todas las conexiones"
echo "âœ… Centralizado: GestiÃ³n de usuarios y conexiones desde Authentik"
echo "âœ… Auditable: Logs completos de quiÃ©n accede a quÃ©"
echo ""

echo "ğŸ”„ COMPARACIÃ“N DE ACCESOS:"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "MÃ‰TODO ACTUAL (Guacamole directo):"
echo "â€¢ http://34.68.124.46:8080/guacamole/"
echo "â€¢ Login individual en Guacamole"
echo "â€¢ GestiÃ³n manual de usuarios"
echo ""
echo "MÃ‰TODO NUEVO (RAC Provider):"
echo "â€¢ https://34.68.124.46:9443/if/user/"
echo "â€¢ Login Ãºnico con credenciales LDAP"
echo "â€¢ GestiÃ³n automÃ¡tica desde Authentik"
echo ""

echo "ğŸ¯ RECOMENDACIÃ“N:"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "Implementa RAC Provider con tus 4 conexiones principales"
echo "MantÃ©n Guacamole como respaldo durante la transiciÃ³n"
echo "EvalÃºa la experiencia de usuario antes de migrar completamente"
echo ""
echo "ğŸš€ Â¿LISTO PARA IMPLEMENTAR?"
echo "Sigue estos pasos y tendrÃ¡s SSO funcionando en 15-20 minutos"